
âœ… Full System Overview: Bank Transaction Analyzer
ğŸ” Identify refunded, duplicate, and unmatched transactions across multiple statements from the same bank, and calculate the total financial impact.

ğŸ¯ Objectives
Your system should:

ğŸ” Detect refunded transactions (same amount, same account, credited back later)

ğŸ” Detect possible duplicate payments, including:

Retries from same or different bank statements

Slight variations in amount (â‚¦1â€“â‚¦1,000)

âŒ Identify unrecovered losses

ğŸ“Š Summarize the total impact in terms of:

Total debits

Total refunded

Total lost to duplicate or unreversed attempts

ğŸ“‘ Output one Excel workbook with organized sheets and color-coded transactions for clarity

ğŸ“¥ Input
ğŸ”¹ Multiple PDF bank statements from same bank

E.g. GTBank_Jan.pdf, GTBank_Feb.pdf

ğŸ”¸ Each file contains:

Date, Time, Narration, Reference, Debit, Credit, Balance

Example Transaction:
Date	Time	Narration (Beneficiary Info)	Reference	Debit	Credit	Balance
01/01/2025	22:11:33	ADESOLA OLUWAFEMI OPARINDE	...	100,020.00	â€”	4,654,173.02

ğŸ§  Core Logic Breakdown
âœ… 1. Data Extraction & Normalization
For each PDF:

Read all transactions

Assign shared Account ID (e.g., GTBank_Main)

Normalize data:

Combine Date + Time â†’ Timestamp

Extract Beneficiary from narration

Convert debit/credit to float

Add:

Txn ID (auto ID)

Account ID

Txn Type (debit or credit)

All extracted transactions go into a master DataFrame.

âœ… 2. Refund Detection Logic
ğŸ” Has the money come back?

For every debit transaction:

Search for a credit of exact same amount

From the same account ID (across any file)

With a later timestamp

If found:

Mark as Refunded

Show both transactions side by side

If not found:

Mark as Unmatched Debit

âœ… Helps detect bank errors that were later corrected

âœ… 3. Duplicate / Retry Detection Logic
âš ï¸ Was the MD retrying the same transaction â€” even on the same account â€” possibly with a small change in amount?

Group all debits by Beneficiary

Find 2+ transactions that:

Happened within 3 days

Have amount difference â‰¤ â‚¦1,000

Belong to same account

Or across files/statements

Were not refunded

Group them as Suspected Duplicates

Assign Group ID

âœ… Helps detect accidental overpayments, even if the retry was on the same account

âœ… 4. Balance Tracking
Every transaction carries the Balance from the original statement.

We retain:

Balance at time of debit

Balance at time of refund (if matched)

Balance at time of duplicate retry

âœ… Makes it easy to trace financial position at the time of the incident.

âœ… 5. Final Summary Calculation
ğŸ“Š Whatâ€™s the total damage or recovery?

Calculate:

Metric	How It's Calculated
Total Debit Volume	Sum of all debit amounts
Total Refunded	Sum of debit amounts that were later refunded
Total Unmatched Debits	Debits that were not refunded nor clearly matched
Total Duplicate Amount	Sum of grouped duplicate transactions (excluding first)
Total Net Loss Estimate	Total Duplicate Amount - Total Refunded

âœ… Shows how much money was:

Temporarily deducted

Duplicated

Lost or recovered

ğŸ“Š Excel Output Structure
Youâ€™ll generate a single Excel file with multiple sheets:

ğŸ§¾ Sheet 1: All Transactions
| Txn ID | Date | Time | Beneficiary | Amount | Type | Account ID | Reference | Balance |

All raw and cleaned data, combined from all PDFs.

ğŸŸ© Sheet 2: Refunded Transactions
| Debit Date | Beneficiary | Debit Amount | Account | Credit Date | Credit Amount | Balance (before/after) |

âœ… Colored green

âœ… Debits & matching refunds side-by-side

âœ… Includes balances to show when refund occurred

âŒ Sheet 3: Unmatched Debits
| Txn ID | Date | Beneficiary | Amount | Account | Balance | Status: Not Refunded |

Shows every debit where no refund was ever detected

ğŸ”¶ Sheet 4: Suspected Duplicate Payments
| Group ID | Date | Beneficiary | Amount | Account | Txn ID | Retry Note | Balance |

Includes same-account & cross-file duplicates

Shows all grouped retries, amounts, and dates

Highlighted in yellow

Includes balance at time of each retry

ğŸ“ˆ Sheet 5: Summary of Potential Losses
Metric	Value
Total Transactions	2,345
Total Refunds	â‚¦3,000,000.00
Total Duplicate Groups	12
Total Duplicate Amount	â‚¦4,850,000.00
Estimated Net Loss	â‚¦1,850,000.00

ğŸ§  Example Flow
Scenario:

MD tries to pay â‚¦500,000 to â€œXYZ Ltdâ€

System fails to respond

He retries with â‚¦500,100 on same account

Bank charges both

Refund never comes

System Output:

Both debits grouped as a Duplicate

No refund found

Flagged in yellow

Balance shown for each

Value counted in Net Loss

ğŸ“‚ Suggested Folder Structure
lua
Copy
Edit
bank-analysis/
â”‚
â”œâ”€â”€ statements/
â”‚   â”œâ”€â”€ GTBank_Jan.pdf
â”‚   â”œâ”€â”€ GTBank_Feb.pdf
â”‚
â”œâ”€â”€ output/
â”‚   â””â”€â”€ Transaction_Report.xlsx
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ extract_clean.py
â”‚   â”œâ”€â”€ detect_refunds.py
â”‚   â”œâ”€â”€ detect_duplicates.py
â”‚   â”œâ”€â”€ build_summary.py
â”‚   â””â”€â”€ export_excel.py
âœ… Final Notes
No false positives: legitimate one-time debits are left untouched

Detects:

Refunded issues

Retry duplicates

Silent failures

Clean Excel output ready for management and finance review

Tracks and displays balances for transparency

Helps quantify real-world financial loss